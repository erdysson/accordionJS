{"version":3,"file":"accordion.js","sources":["accordion.js"],"names":["Accordion","selector","config","initialize","accordions","Array","prototype","slice","call","accordionContainer","querySelectorAll","forEach","accordion","trigger","querySelector","accordionMenu","providerName","getAttribute","addEventListener","_eventHandler","__asyncLoaderFn","__closeOthersFn","_loadCustomProvider","deferred","Q","defer","cachedContent","fnToBeCalled","fcall","customData","provider","then","resolved","cache","_removeCustomDOM","_createCustomDOM","resolve","error","reject","promise","menu","data","dataInstance","li","document","createElement","innerHTML","classList","add","appendChild","firstChild","removeChild","closeOthers","currentOpenAccordionMenu","_hide","_show","console","log","callback","e","isShown","indexOf","preventDefault","remove","$initialize","window"],"mappings":"CAGA,WACE,YACA,SAASA,GAAUC,EAAUC,GAM3B,QAASC,KACP,GAAIC,GAAaC,MAAMC,UAAUC,MAAMC,KAAKC,EAAmBC,iBAAiB,cAAe,EAC/FN,GAAWO,QAAQ,SAASC,GAC1B,GAAIC,GAAUD,EAAUE,cAAc,eAClCC,EAAgBH,EAAUE,cAAc,mBAExCE,EAAeH,EAAQI,aAAa,mBACpCD,GACFH,EAAQK,iBAAiB,QAASC,EAAcJ,EAAeK,EAAgBL,EAAeC,KAE9FH,EAAQK,iBAAiB,QAASC,EAAcJ,EAAeM,EAAgBN,OAKrF,QAASO,GAAoBP,EAAeC,GAC1C,GAAIO,GAAWC,EAAEC,OACjB,KAAIC,EAAcV,GAEX,CACL,GAAIW,GAAeH,EAAEI,MAAM1B,EAAO2B,WAAWb,GAAcc,SAC3D,OAAOH,GACJI,KAAK,SAASC,GACT9B,EAAO2B,WAAWb,GAAciB,SAAU,EAC5CP,EAAcV,IAAgB,EAE9BkB,EAAiBnB,GAEnBoB,EAAiBpB,EAAeiB,GAChCT,EAASa,YARNT,SAUE,SAASU,GACdd,EAASe,OAAOD,KAGtB,MAjBEd,GAASa,UAiBJb,EAASgB,QAGlB,QAASJ,GAAiBK,EAAMC,GAC9BA,EAAK9B,QAAQ,SAAS+B,GACpB,GAAIC,GAAKC,SAASC,cAAc,KAChCF,GAAGG,UAAYJ,EACfC,EAAGI,UAAUC,IAAI,kBACjBR,EAAKS,YAAYN,KAIrB,QAAST,GAAiBnB,GACxB,KAAOA,EAAcmC,YACnBnC,EAAcoC,YAAYpC,EAAcmC,WAE1C,QAAO,EAGT,QAAS7B,GAAgBN,GACvB,MAAO,YACDqC,GAA4C,OAA7BC,GACjBC,EAAMD,GAERE,EAAMxC,IAIV,QAASK,GAAgBL,EAAeC,GACtC,MAAO,YACLM,EAAoBP,EAAeC,GAChCe,KAAKV,EAAgBN,IADxBO,SAES,SAASe,GACdmB,QAAQC,IAAI,yBAA0BpB,MAK9C,QAASlB,GAAcJ,EAAe2C,GACpC,MAAO,UAASC,GACd,GAAIC,GAAUvD,MAAMC,UAAUC,MAAMC,KAAKO,EAAcgC,UAAU,GAAGc,QAAQ,QAAU,EACjFD,GAGHN,EAAMvC,GAFN2C,IAIFC,EAAEG,kBAIN,QAASP,GAAMxC,GAIb,MAHAA,GAAcgC,UAAUgB,OAAO,QAC/BhD,EAAcgC,UAAUC,IAAI,QAC5BK,EAA2BtC,GACpB,EAGT,QAASuC,GAAMvC,GAIb,MAHAA,GAAcgC,UAAUgB,OAAO,QAC/BhD,EAAcgC,UAAUC,IAAI,QAC5BK,EAA2B,MACpB,EArGT,GAAI5C,GAAqBmC,SAAS9B,cAAcb,GAC5CmD,EAA2C,iBAAtBlD,GAAOkD,YAA2BlD,EAAOkD,aAAc,EAC5EC,EAA2B,KAC3B3B,IAqGJ,QACEsC,YAAa7D,GAIjB8D,OAAOjE,UAAYA","sourcesContent":["/**\n * Created by erdi.taner.gokalp on 27/10/15.\n */\n(function() {\n  \"use strict\";\n  function Accordion(selector, config) {\n    var accordionContainer = document.querySelector(selector);\n    var closeOthers = typeof config.closeOthers == \"boolean\" ? config.closeOthers : false;\n    var currentOpenAccordionMenu = null;\n    var cachedContent = {};\n\n    function initialize() {\n      var accordions = Array.prototype.slice.call(accordionContainer.querySelectorAll(\".accordion\"), 0);\n      accordions.forEach(function(accordion){\n        var trigger = accordion.querySelector(\"[accordion]\");\n        var accordionMenu = accordion.querySelector(\".accordion-menu\");\n\n        var providerName = trigger.getAttribute(\"content-provider\");\n        if (providerName) {\n          trigger.addEventListener(\"click\", _eventHandler(accordionMenu, __asyncLoaderFn(accordionMenu, providerName)));\n        } else {\n          trigger.addEventListener(\"click\", _eventHandler(accordionMenu, __closeOthersFn(accordionMenu)));\n        }\n      });\n    }\n\n    function _loadCustomProvider(accordionMenu, providerName) {\n      var deferred = Q.defer();\n      if (cachedContent[providerName]) {\n        deferred.resolve();\n      } else {\n        var fnToBeCalled = Q.fcall(config.customData[providerName].provider);\n        return fnToBeCalled\n          .then(function(resolved) {\n            if (config.customData[providerName].cache === true) {\n              cachedContent[providerName] = true;\n            } else {\n              _removeCustomDOM(accordionMenu);\n            }\n            _createCustomDOM(accordionMenu, resolved);\n            deferred.resolve();\n          })\n          .catch(function(error) {\n            deferred.reject(error);\n          });\n      }\n      return deferred.promise;\n    }\n\n    function _createCustomDOM(menu, data) {\n      data.forEach(function(dataInstance) {\n        var li = document.createElement(\"li\");\n        li.innerHTML = dataInstance;\n        li.classList.add(\"accordion-item\");\n        menu.appendChild(li);\n      });\n    }\n\n    function _removeCustomDOM(accordionMenu) {\n      while (accordionMenu.firstChild) {\n        accordionMenu.removeChild(accordionMenu.firstChild);\n      }\n      return true;\n    }\n\n    function __closeOthersFn(accordionMenu) {\n      return function() {\n        if (closeOthers && currentOpenAccordionMenu !== null) {\n          _hide(currentOpenAccordionMenu);\n        }\n        _show(accordionMenu);\n      };\n    }\n\n    function __asyncLoaderFn(accordionMenu, providerName) {\n      return function() {\n        _loadCustomProvider(accordionMenu, providerName)\n          .then(__closeOthersFn(accordionMenu))\n          .catch(function(error) {\n            console.log(\"error in async handler\", error);\n          });\n      };\n    }\n\n    function _eventHandler(accordionMenu, callback) {\n      return function(e) {\n        var isShown = Array.prototype.slice.call(accordionMenu.classList,0).indexOf(\"show\") > -1;\n        if (!isShown) {\n          callback();\n        } else {\n          _hide(accordionMenu);\n        }\n        e.preventDefault();\n      };\n    }\n\n    function _show(accordionMenu) {\n      accordionMenu.classList.remove(\"hide\");\n      accordionMenu.classList.add(\"show\");\n      currentOpenAccordionMenu = accordionMenu;\n      return true;\n    }\n\n    function _hide(accordionMenu) {\n      accordionMenu.classList.remove(\"show\");\n      accordionMenu.classList.add(\"hide\");\n      currentOpenAccordionMenu = null;\n      return true;\n    }\n\n    return {\n      $initialize: initialize\n    };\n  }\n  // open to public\n  window.Accordion = Accordion;\n})();\n"],"sourceRoot":"/source/"}