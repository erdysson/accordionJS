{"version":3,"file":"accordion.js","sources":["accordion.js"],"names":["Accordion","selector","config","initialize","accordions","Array","prototype","slice","call","accordionContainer","querySelectorAll","forEach","accordion","trigger","querySelector","accordionMenu","providerName","getAttribute","addEventListener","_eventHandler","__asyncLoaderFn","__closeOthersFn","_loadCustomProvider","deferred","Q","defer","cachedContent","resolve","customData","provider","then","resolved","cache","_removeCustomDOM","_createCustomDOM","error","reject","promise","menu","data","dataInstance","li","document","createElement","innerHTML","classList","add","appendChild","firstChild","removeChild","closeOthers","currentOpenAccordionMenu","_hide","_show","console","log","callback","e","isShown","indexOf","preventDefault","remove","$initialize","window"],"mappings":"CAGA,WACE,YACA,SAASA,GAAUC,EAAUC,GAM3B,QAASC,KACP,GAAIC,GAAaC,MAAMC,UAAUC,MAAMC,KAAKC,EAAmBC,iBAAiB,cAAe,EAC/FN,GAAWO,QAAQ,SAASC,GAC1B,GAAIC,GAAUD,EAAUE,cAAc,eAClCC,EAAgBH,EAAUE,cAAc,mBAExCE,EAAeH,EAAQI,aAAa,mBACpCD,GACFH,EAAQK,iBAAiB,QAASC,EAAcJ,EAAeK,EAAgBL,EAAeC,KAE9FH,EAAQK,iBAAiB,QAASC,EAAcJ,EAAeM,EAAgBN,OAKrF,QAASO,GAAoBP,EAAeC,GAC1C,GAAIO,GAAWC,EAAEC,OAkBjB,OAjBIC,GAAcV,GAChBO,EAASI,UAETzB,EAAO0B,WAAWZ,GAAca,WAC7BC,KAAK,SAASC,GACT7B,EAAO0B,WAAWZ,GAAcgB,SAAU,EAC5CN,EAAcV,IAAgB,EAE9BiB,EAAiBlB,GAEnBmB,EAAiBnB,EAAegB,GAChCR,EAASI,YARbzB,SAUS,SAASiC,GACdZ,EAASa,OAAOD,KAGfZ,EAASc,QAGlB,QAASH,GAAiBI,EAAMC,GAC9BA,EAAK5B,QAAQ,SAAS6B,GACpB,GAAIC,GAAKC,SAASC,cAAc,KAChCF,GAAGG,UAAYJ,EACfC,EAAGI,UAAUC,IAAI,kBACjBR,EAAKS,YAAYN,KAIrB,QAASR,GAAiBlB,GACxB,KAAOA,EAAciC,YACnBjC,EAAckC,YAAYlC,EAAciC,WAE1C,QAAO,EAGT,QAAS3B,GAAgBN,GACvB,MAAO,YACDmC,GAA4C,OAA7BC,GACjBC,EAAMD,GAERE,EAAMtC,IAIV,QAASK,GAAgBL,EAAeC,GACtC,MAAO,YACLM,EAAoBP,EAAeC,GAChCc,KAAKT,EAAgBN,IADxBO,SAES,SAASa,GACdmB,QAAQC,IAAI,yBAA0BpB,MAK9C,QAAShB,GAAcJ,EAAeyC,GACpC,MAAO,UAASC,GACd,GAAIC,GAAUrD,MAAMC,UAAUC,MAAMC,KAAKO,EAAc8B,UAAU,GAAGc,QAAQ,QAAU,EACjFD,GAGHN,EAAMrC,GAFNyC,IAIFC,EAAEG,kBAIN,QAASP,GAAMtC,GAIb,MAHAA,GAAc8B,UAAUgB,OAAO,QAC/B9C,EAAc8B,UAAUC,IAAI,QAC5BK,EAA2BpC,GACpB,EAGT,QAASqC,GAAMrC,GAIb,MAHAA,GAAc8B,UAAUgB,OAAO,QAC/B9C,EAAc8B,UAAUC,IAAI,QAC5BK,EAA2B,MACpB,EApGT,GAAI1C,GAAqBiC,SAAS5B,cAAcb,GAC5CiD,EAA2C,iBAAtBhD,GAAOgD,YAA2BhD,EAAOgD,aAAc,EAC5EC,EAA2B,KAC3BzB,IAoGJ,QACEoC,YAAa3D,GAIjB4D,OAAO/D,UAAYA","sourcesContent":["/**\n * Created by erdi.taner.gokalp on 27/10/15.\n */\n(function() {\n  \"use strict\";\n  function Accordion(selector, config) {\n    var accordionContainer = document.querySelector(selector);\n    var closeOthers = typeof config.closeOthers == \"boolean\" ? config.closeOthers : false;\n    var currentOpenAccordionMenu = null;\n    var cachedContent = {};\n\n    function initialize() {\n      var accordions = Array.prototype.slice.call(accordionContainer.querySelectorAll(\".accordion\"), 0);\n      accordions.forEach(function(accordion){\n        var trigger = accordion.querySelector(\"[accordion]\");\n        var accordionMenu = accordion.querySelector(\".accordion-menu\");\n\n        var providerName = trigger.getAttribute(\"content-provider\");\n        if (providerName) {\n          trigger.addEventListener(\"click\", _eventHandler(accordionMenu, __asyncLoaderFn(accordionMenu, providerName)));\n        } else {\n          trigger.addEventListener(\"click\", _eventHandler(accordionMenu, __closeOthersFn(accordionMenu)));\n        }\n      });\n    }\n\n    function _loadCustomProvider(accordionMenu, providerName) {\n      var deferred = Q.defer();\n      if (cachedContent[providerName]) {\n        deferred.resolve();\n      } else {\n        config.customData[providerName].provider()\n          .then(function(resolved) {\n            if (config.customData[providerName].cache === true) {\n              cachedContent[providerName] = true;\n            } else {\n              _removeCustomDOM(accordionMenu);\n            }\n            _createCustomDOM(accordionMenu, resolved);\n            deferred.resolve();\n          })\n          .catch(function(error) {\n            deferred.reject(error);\n          });\n      }\n      return deferred.promise;\n    }\n\n    function _createCustomDOM(menu, data) {\n      data.forEach(function(dataInstance) {\n        var li = document.createElement(\"li\");\n        li.innerHTML = dataInstance;\n        li.classList.add(\"accordion-item\");\n        menu.appendChild(li);\n      });\n    }\n\n    function _removeCustomDOM(accordionMenu) {\n      while (accordionMenu.firstChild) {\n        accordionMenu.removeChild(accordionMenu.firstChild);\n      }\n      return true;\n    }\n\n    function __closeOthersFn(accordionMenu) {\n      return function() {\n        if (closeOthers && currentOpenAccordionMenu !== null) {\n          _hide(currentOpenAccordionMenu);\n        }\n        _show(accordionMenu);\n      };\n    }\n\n    function __asyncLoaderFn(accordionMenu, providerName) {\n      return function() {\n        _loadCustomProvider(accordionMenu, providerName)\n          .then(__closeOthersFn(accordionMenu))\n          .catch(function(error) {\n            console.log(\"error in async handler\", error);\n          });\n      };\n    }\n\n    function _eventHandler(accordionMenu, callback) {\n      return function(e) {\n        var isShown = Array.prototype.slice.call(accordionMenu.classList,0).indexOf(\"show\") > -1;\n        if (!isShown) {\n          callback();\n        } else {\n          _hide(accordionMenu);\n        }\n        e.preventDefault();\n      };\n    }\n\n    function _show(accordionMenu) {\n      accordionMenu.classList.remove(\"hide\");\n      accordionMenu.classList.add(\"show\");\n      currentOpenAccordionMenu = accordionMenu;\n      return true;\n    }\n\n    function _hide(accordionMenu) {\n      accordionMenu.classList.remove(\"show\");\n      accordionMenu.classList.add(\"hide\");\n      currentOpenAccordionMenu = null;\n      return true;\n    }\n\n    return {\n      $initialize: initialize\n    };\n  }\n  // open to public\n  window.Accordion = Accordion;\n})();\n"],"sourceRoot":"/source/"}